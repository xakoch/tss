document.addEventListener("DOMContentLoaded",function(){window.addEventListener("unhandledrejection",function(e){console.warn("Unhandled promise rejection:",e.reason)}),"undefined"!=typeof barba?initPageTransitions():(console.warn("Barba.js not found. Initializing script directly."),initScript(document.body))});let lenis;function initLenis(){try{var e;"undefined"==typeof Lenis?console.warn("Lenis not found"):(lenis&&lenis.destroy(),lenis=new Lenis({duration:1.2,easing:e=>Math.min(1,1.001-Math.pow(2,-10*e)),direction:"vertical",gestureDirection:"vertical",smooth:!0,mouseMultiplier:1,smoothTouch:!1,touchMultiplier:2,infinite:!1}),requestAnimationFrame(function e(t){lenis&&lenis.raf(t),requestAnimationFrame(e)}),0<(e=document.querySelectorAll('a[href^="#"]:not([href="#"])')).length&&e.forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();e=this.getAttribute("href"),e=document.querySelector(e);e&&lenis?lenis.scrollTo(e,{offset:0,duration:1.2,easing:e=>Math.min(1,1.001-Math.pow(2,-10*e))}):e&&e.scrollIntoView({behavior:"smooth"})})}))}catch(e){console.error("Error in initLenis:",e)}}function initPageTransitions(){try{barba.hooks.beforeLeave(e=>{"undefined"!=typeof jQuery&&"function"==typeof initBarbaNavUpdate&&initBarbaNavUpdate(e),window.scrollTo({top:0,behavior:"instant"})}),barba.hooks.afterEnter(e=>{initScript(e.next.container),"undefined"!=typeof gsap&&e.next.container?gsap.to(e.next.container,{opacity:1,duration:.5,ease:"power1.out"}):e.next.container&&(e.next.container.style.opacity="1")}),barba.hooks.beforeEnter(e=>{var t;e.next.container&&(e.next.container.style.opacity="0"),updateBodyClass(e.next.html),"undefined"!=typeof gsap&&(t=e.next.container.querySelector(".header"),e=e.next.container.querySelector(".hero__title h1"),t&&gsap.set(t,{opacity:0,y:-30}),e)&&gsap.set(e,{opacity:0,y:50})}),barba.init({sync:!1,debug:!1,timeout:7e3,transitions:[{name:"default",once({next:e}){updateBodyClass(e.html),initScript(e.container),"undefined"!=typeof gsap&&gsap.from(e.container,{opacity:0,duration:.5,ease:"power1.out",clearProps:"all"})},async leave(e){try{e&&e.current&&e.current.container&&("undefined"!=typeof gsap?await gsap.to(e.current.container,{opacity:0,duration:.3,ease:"power1.in"}):(e.current.container.style.opacity="0",await delay(300)))}catch(e){console.error("Error in leave transition:",e)}},async enter({next:t}){try{var e,a,n;"undefined"!=typeof gsap&&((e=gsap.timeline({onComplete:()=>{}})).to(t.container,{opacity:1,duration:.5,ease:"power1.out"}),a=t.container.querySelector(".header"),n=t.container.querySelector(".hero__title h1"),a&&e.to(a,{opacity:1,y:0,duration:.8,ease:"power2.out"},"-=0.3"),n)&&e.to(n,{opacity:1,y:0,duration:.8,ease:"power2.out"},"-=0.5")}catch(e){console.error("Error in enter transition:",e),t.container&&(t.container.style.opacity="1")}}}]})}catch(e){console.error("Error in initPageTransitions:",e),initScript(document.body)}}function updateBodyClass(e){try{var t;e&&(t=e.match(/<body.+?class="([^"]*)"/i),document.body.className=t?t[1]:"")}catch(e){console.error("Error in updateBodyClass:",e)}}function delay(t=2e3){return new Promise(e=>setTimeout(e,t))}function initBarbaNavUpdate(e){try{if("undefined"!=typeof jQuery&&e&&e.next&&e.next.html){const t=jQuery,a=t(e.next.html).find("[data-barba-update]");0<a.length&&t("[data-barba-update]").each(function(e){0<t(a[e]).length&&(e=t(a[e]).attr("data-link-status"),t(this).attr("data-link-status",e))})}}catch(e){console.error("Error in initBarbaNavUpdate:",e)}}function initWindowInnerheight(){try{var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",e+"px"),window.addEventListener("resize",()=>{var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",e+"px")})}catch(e){console.error("Error in initWindowInnerheight:",e)}}function initScript(e=document.body){try{lenis||initLenis(),initWindowInnerheight(),initSwiperSlider(e),initBtnMenuOpenClose(e),animateCommonElements(e),setTimeout(()=>{initDynamicVideoModal(e)},100);var t=e.querySelectorAll(".slider-block"),a=(0<t.length&&initSliderBlocks(t),e.querySelectorAll(".typecard__tab")),n=e.querySelectorAll(".typecard__content"),o=(0<a.length&&0<n.length&&initTypecardTabs(a,n),isHomePage(e)&&initHomePage(e),initModals(e),initCalc(e),initMultiStepForm(e),e.querySelectorAll(".anime-number")),r=(0<o.length&&initAnimNumbers(o),initVerification(e),e.querySelector(".login-page"));r&&initLoginPage(r)}catch(e){console.error("Error in initScript:",e)}}function initVerification(e){var t=e.querySelector(".verification-section"),e=e.querySelector(".verification-empty-dashboard");e&&initVerificationEmptyDashboard(e),t&&initClientVerificationForm(t)}function initVerificationEmptyDashboard(e){var t;e&&((t=e.querySelector(".contact-support-btn"))&&!t.dataset.handlerVedb&&(t.addEventListener("click",function(e){e.preventDefault();e=document.querySelector(".need-assistance");e&&e.scrollIntoView({behavior:"smooth"})}),t.dataset.handlerVedb="true"),e.querySelectorAll(".action-card").forEach(function(e){if(!e.dataset.handlerVedb){const t=e.querySelector(".action-icon");t&&(e.addEventListener("mouseenter",function(){t.style.transform="scale(1.1)",t.style.transition="transform 0.3s ease"}),e.addEventListener("mouseleave",function(){t.style.transform="scale(1)"})),e.dataset.handlerVedb="true"}}))}function handleFileChange(t,e,a,n,o){t=t.files[0];if(e&&a&&n&&o)if(t)if(e.style.display="none",a.textContent=t.name,a.style.display="block",n.textContent="Нажмите для изменения файла",t.type.startsWith("image/")){var r=new FileReader;r.onload=function(e){try{o.innerHTML=`<img src="${e.target.result}" alt="Preview" style="max-width: 100%; max-height: 150px; border-radius: 5px;">`,o.style.display="block"}catch(e){o.innerHTML="<div>File uploaded</div>",o.style.display="block"}},r.onerror=function(){o.innerHTML="<div>File uploaded</div>",o.style.display="block"},r.readAsDataURL(t)}else{let e="fa-file";"application/pdf"===t.type&&(e="fa-file-pdf"),o.innerHTML=`<i class="fas ${e}" style="font-size: 48px; color: #0056b3;"></i>`,o.style.display="block"}else e.style.display="block",a.textContent="Перетащите файл сюда или нажмите для загрузки",a.style.display="block",n.textContent="JPG, PNG или PDF (Макс 10МБ)",n.style.display="block",o.innerHTML="",o.style.display="none"}function setupDragAndDrop(e,t){e.addEventListener("dragover",function(e){e.preventDefault(),e.stopPropagation(),t.disabled||(this.style.borderColor="#0056b3",this.style.backgroundColor="#f8f9fa")}),e.addEventListener("dragleave",function(e){e.preventDefault(),e.stopPropagation(),this.style.borderColor="#dee2e6",this.style.backgroundColor="transparent"}),e.addEventListener("drop",function(e){e.preventDefault(),e.stopPropagation(),this.style.borderColor="#dee2e6",this.style.backgroundColor="transparent",!t.disabled&&e.dataTransfer&&e.dataTransfer.files.length&&(t.files=e.dataTransfer.files,t.dispatchEvent(new Event("change",{bubbles:!0})))})}function updateUploadButton(){var e=document.querySelector("#upload-button");if(e){let t=!1;document.querySelectorAll(".verification-file-input:not(:disabled)").forEach(function(e){e.files&&0<e.files.length&&(t=!0)}),e.disabled=!t}}function initClientVerificationForm(r){if(r){let o=r.querySelector("#verification-global-message-area-ajax");function m(e,t="error"){var a,n;o&&(a="success"===t?"alert-success-vf-ajax":"alert-error-vf-ajax",n="success"===t?"#e8f5e9":"#ffebee",t="success"===t?"#2e7d32":"#c62828",o.innerHTML=`<div class="alert-vf-ajax ${a}" style="padding:12px 15px; margin-bottom:20px; border-radius:4px; background-color:${n}; color:${t}; border: 1px solid ${t};">
                ${e}
             </div>`,o.style.display="block",setTimeout(()=>{o.firstChild&&(o.firstChild.style.transition="opacity 0.5s ease",o.firstChild.style.opacity="0",setTimeout(()=>{o.innerHTML="",o.style.display="none"},500))},7e3))}o||((o=document.createElement("div")).id="verification-global-message-area-ajax",o.style.marginBottom="20px",r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o)),r.querySelectorAll(".client-verification-file-input").forEach(t=>{if("true"!==t.dataset.ajaxListenerAttached){t.dataset.ajaxListenerAttached="true";const n=t.closest(".document-upload-area-client");if(n){var e=t.dataset.docType;const l=n.querySelector(".file-preview-client")||r.querySelector("#preview_"+e),d=n.querySelector(".upload-progress-client")||r.querySelector("#progress_"+e),c=d?d.querySelector(".progress-bar-client"):null,u=n.querySelector(".upload-message-client")||r.querySelector("#message_"+e),p=r.querySelector("#status-text-"+e),y=n.querySelector(".upload-icon-client"),f=n.querySelector(".upload-text-client");e=n.querySelector('label[for="'+t.id+'"]');function a(e){var t=e.target.files[0];if(u&&(u.textContent="",u.className="upload-message-client"),d&&(d.style.display="none"),c&&(c.style.width="0%"),t)if(10485760<t.size)u&&(u.textContent="Error: File is too large (max 10MB).",u.className="upload-message-client error"),e.target.value="",f&&(f.textContent="File too large. Try again."),y&&(y.style.display="block"),l&&(l.innerHTML="");else if(["image/jpeg","image/png","application/pdf"].includes(t.type)){l&&(l.textContent=`${t.name} (${(t.size/1024/1024).toFixed(2)} MB)`),f&&(f.textContent="File selected."),y&&(y.style.display="none");var a=t,n=e.target,t=n.dataset.requestId,o=n.dataset.docType,r=n.dataset.nonce;if(t&&o&&r){var i=new FormData;i.append("action","tss_upload_client_document"),i.append("request_id",t),i.append("doc_type",o),i.append("_ajax_nonce",r),i.append("document_file",a),d&&(d.style.display="block"),c&&(c.style.width="0%"),u&&(u.textContent="Uploading...",u.className="upload-message-client info");const s=new XMLHttpRequest;t="undefined"!=typeof tss_ajax_object&&tss_ajax_object.ajax_url?tss_ajax_object.ajax_url:"undefined"!=typeof ajaxurl?ajaxurl:"/wp-admin/admin-ajax.php";s.open("POST",t,!0),s.upload.onprogress=function(e){e.lengthComputable&&c&&(e=e.loaded/e.total*100,c.style.width=e.toFixed(0)+"%")},s.onload=function(){if(d&&setTimeout(()=>{d.style.display="none"},1500),c&&(c.style.width="0%"),200<=s.status&&s.status<400)try{var e=JSON.parse(s.responseText);e.success?(u&&(u.textContent=e.data.message||"Upload successful! Awaiting review.",u.className="upload-message-client success"),f&&(f.textContent="File changed. Re-upload if needed."),y&&(y.style.display="block"),l&&e.data.doc_data&&e.data.doc_data.file_name_original?l.textContent="Current: "+e.data.doc_data.file_name_original:l&&(l.textContent="Current: "+a.name),p&&(p.innerHTML='<span style="background:#fff3e0; color:#e65100; padding:2px 8px; border-radius:10px; font-size:12px; display:inline-block;">Under Review</span>'),m('Document "'+(e.data.doc_data?e.data.doc_data.file_name_original:a.name)+'" uploaded. It is now under review.',"success")):(u&&(u.textContent="Error: "+(e.data.message||"Upload failed."),u.className="upload-message-client error"),m('Error uploading "'+a.name+'": '+(e.data.message||"Unknown server error."),"error"))}catch(e){u&&(u.textContent="Error: Invalid server response.",u.className="upload-message-client error"),m('Error uploading "'+a.name+'": Invalid server response.',"error")}else u&&(u.textContent=`Error: Upload failed (Status: ${s.status}).`,u.className="upload-message-client error"),m('Error uploading "'+a.name+`": Server error (Status ${s.status}).`,"error");n.value=""},s.onerror=function(){d&&(d.style.display="none"),c&&(c.style.width="0%"),u&&(u.textContent="Error: Network issue.",u.className="upload-message-client error"),n.value="",m('Error uploading "'+a.name+'": Network error.',"error")},s.send(i)}else console.error("Upload Error: Missing data attributes for AJAX."),u&&(u.textContent="Error: Upload configuration missing.",u.className="upload-message-client error")}else u&&(u.textContent="Error: Invalid file type (JPG, PNG, PDF only).",u.className="upload-message-client error"),e.target.value="",f&&(f.textContent="Invalid type. Try again."),y&&(y.style.display="block"),l&&(l.innerHTML="");else f&&(f.textContent="Click or drag file here"),y&&(y.style.display="block"),l&&(l.innerHTML="")}e?e.dataset.customFileClickListener||(e.addEventListener("click",function(e){e.target!==t&&t.disabled}),e.dataset.customFileClickListener="true"):n&&n.contains(t)&&(n.dataset.customFileClickListener||(n.addEventListener("click",function(e){e.target===t||t.disabled||t.click()}),n.dataset.customFileClickListener="true")),["dragenter","dragover","dragleave","drop"].forEach(e=>{n.addEventListener(e,e=>{e.preventDefault(),e.stopPropagation()},!1)}),["dragenter","dragover"].forEach(e=>{n.addEventListener(e,()=>{t.disabled||(n.style.borderColor="#007bff")},!1)}),["dragleave","drop"].forEach(e=>{n.addEventListener(e,()=>{t.disabled||(n.style.borderColor="#ccc")},!1)}),n.addEventListener("drop",e=>{t.disabled||0<(e=e.dataTransfer.files).length&&(t.files=e,a({target:t}))},!1),t.addEventListener("change",a)}else console.warn("Upload area not found for input:",t)}})}}function initDynamicVideoModal(e=document.body){var t="dynamic-video-modal";let o=e.querySelector("#"+t)||document.getElementById(t);if((o=o||(document.getElementById(t)||((e=document.createElement("div")).innerHTML=`
                <div class="modal modal__reviews" id="dynamic-video-modal" style="display:none;">
                    <div class="modal__content">
                        <button class="modal__close" data-modal-close>✕</button>
                        <div class="video-container">
                            <div class="video-placeholder" style="display:flex; align-items:center; justify-content:center; min-height:200px; background:#f0f0f0;">
                                <div class="loader">Loading...</div>
                            </div>
                        </div>
                    </div>
                    <div class="modal__overlay" style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:-1;"></div>
                </div>`,document.body.appendChild(e.firstElementChild)),document.getElementById(t)))&&"true"!==o.dataset.videoHandlerAttached){const r=o.querySelector(".video-container"),i=o.querySelector(".video-placeholder");e=o.querySelector("[data-modal-close]");o.querySelector(".modal__overlay");let n=null;if(window.youtubeApiPromise||(window.youtubeApiPromise=new Promise((e,t)=>{try{var a,n;window.YT?e():((a=document.createElement("script")).src="https://www.youtube.com/iframe_api",a.onerror=()=>t(new Error("Failed to load YouTube API script")),(n=document.getElementsByTagName("script")[0])&&n.parentNode?n.parentNode.insertBefore(a,n):document.head.appendChild(a),window.onYouTubeIframeAPIReady=function(){e()},setTimeout(()=>{window.YT||t(new Error("YouTube API load timeout"))},1e4))}catch(e){t(e)}}),window.youtubeApiPromise.catch(e=>console.warn("Failed to load YouTube API:",e))),document.body.addEventListener("click",function(t){var e=t.target.closest("[data-modal-open^='modal-reviews-']");if(e&&o){t.preventDefault();t=function(e){if(e.hasAttribute("data-video-id"))return e.getAttribute("data-video-id");if(e=e.getAttribute("data-modal-open")){e=document.getElementById(e);if(e){e=e.querySelector("iframe");if(e&&e.getAttribute("src")){e=e.getAttribute("src");if(!e)return null;e=e.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/);return e&&11===e[2].length?e[2]:null;return}}}return null}(e);if(t){{var a=t;t="youtube-player-dynamic-instance";let e=r.querySelector("#"+t);e&&e.remove(),i.style.display="flex",i.innerHTML='<div class="loader">Loading...</div>',(e=document.createElement("div")).id=t,r.appendChild(e),window.youtubeApiPromise.then(()=>{try{YT.Player?n=new YT.Player(e.id,{videoId:a,playerVars:{autoplay:1,modestbranding:1,rel:0,showinfo:0,controls:1,origin:window.location.origin},events:{onReady:e=>{i.style.display="none"},onError:e=>{console.error("Error loading video "+a,e),i.innerHTML="Error loading video"}}}):(console.error("YT.Player is not available"),i.innerHTML="Error: YT.Player unavailable.")}catch(e){console.error("Error creating YouTube player:",e),i.innerHTML="Error creating player"}}).catch(e=>{console.error("YouTube API not ready for createYouTubePlayer:",e),i.innerHTML="Error: YouTube API failed to initialize."})}o.classList.add("is-active"),o.style.display="block",lenis&&"function"==typeof lenis.stop&&lenis.stop()}else console.error("Video ID not found for button:",e)}}),e&&e.addEventListener("click",e=>{e.preventDefault(),a()}),o){const s=o.querySelector(".modal__overlay")||o;s.addEventListener("click",e=>{e.target===s&&(e.preventDefault(),a())}),o.dataset.videoHandlerAttached="true"}function a(){if(n&&"function"==typeof n.destroy){try{n.stopVideo(),n.destroy()}catch(e){console.warn("Error destroying player",e)}n=null}o.classList.remove("is-active"),o.style.display="none",lenis&&"function"==typeof lenis.start&&lenis.start()}document.addEventListener("keydown",e=>{"Escape"===e.key&&o&&o.classList.contains("is-active")&&(e=o.querySelector("[data-modal-close]"))&&e.click()})}}function initModals(e=document.body){try{var t=e.querySelectorAll("[data-modal-open]:not([data-modal-open^='modal-reviews-'])"),a=document.querySelectorAll(".modal:not(#dynamic-video-modal)");t.forEach(t=>{t.dataset.modalHandlerAttached||(t.addEventListener("click",e=>{e.preventDefault();e=t.getAttribute("data-modal-open"),e=document.getElementById(e);e&&(e.classList.add("is-active"),e.style.display="block",lenis)&&"function"==typeof lenis.stop&&lenis.stop()}),t.dataset.modalHandlerAttached="true")}),a.forEach(t=>{t.dataset.modalHandlersSet||(t.querySelectorAll("[data-modal-close]").forEach(e=>{e.dataset.modalCloseHandler||(e.addEventListener("click",e=>{e.preventDefault(),t.classList.remove("is-active"),t.style.display="none",document.querySelector(".modal.is-active")||lenis&&"function"==typeof lenis.start&&lenis.start()}),e.dataset.modalCloseHandler="true")}),t.addEventListener("click",e=>{e.target===t&&(t.classList.remove("is-active"),t.style.display="none",document.querySelector(".modal.is-active")||lenis&&"function"==typeof lenis.start&&lenis.start())}),t.dataset.modalHandlersSet="true")}),document.body.dataset.genericModalEscapeListener||(document.addEventListener("keydown",e=>{"Escape"===e.key&&(e=document.querySelector(".modal.is-active:not(#dynamic-video-modal)"))&&(e=e.querySelector("[data-modal-close]"))&&e.click()}),document.body.dataset.genericModalEscapeListener="true")}catch(e){console.error("Error in initModals:",e)}}function initBtnMenuOpenClose(e=document.body){const t=document.body,a=document.querySelector(".burger");if(a){"true"===a.dataset.menuOpened&&a.classList.contains("is-active")||"true"===a.dataset.menuHandlerAttached&&!a.classList.contains("is-active")||(a.dataset.menuHandlerAttached="true");const o=document.querySelector(".mobile__menu");function n(){var e=a.classList.toggle("is-active");t.classList.toggle("overflow-hidden",e),o.classList.toggle("is-open",e),e?"undefined"!=typeof gsap?gsap.to(o,{display:"block",autoAlpha:1,duration:.3,ease:"power2.out"}):o.style.display="block":"undefined"!=typeof gsap?gsap.to(o,{autoAlpha:0,duration:.3,ease:"power2.in",onComplete:()=>gsap.set(o,{display:"none"})}):o.style.display="none"}o&&("undefined"==typeof gsap||o.dataset.gsapInit?o.dataset.gsapInit||(o.style.display="none"):(gsap.set(o,{autoAlpha:0,display:"none"}),o.dataset.gsapInit="true"),a.dataset.mainClickListener||(a.addEventListener("click",e=>{e.preventDefault(),n()}),a.dataset.mainClickListener="true"),o.querySelectorAll("a").forEach(t=>{t.dataset.menuLinkListener||(t.addEventListener("click",e=>{o.classList.contains("is-open")&&(t.getAttribute("href")&&t.getAttribute("href").startsWith("#"),n())}),t.dataset.menuLinkListener="true")}))}}function animateCommonElements(e=document.body){try{if("undefined"!=typeof gsap){var t=e.querySelector(".header"),a=(t&&!t.dataset.gsapAnimated&&(gsap.fromTo(t,{y:-30,autoAlpha:0},{y:0,autoAlpha:1,duration:.8,ease:"power2.out",delay:.1}),t.dataset.gsapAnimated="true"),e.querySelector(".hero__title h1"));a&&!a.dataset.gsapAnimated&&(gsap.fromTo(a,{opacity:0,y:50},{opacity:1,y:0,duration:.8,delay:.2,ease:"power2.out"}),a.dataset.gsapAnimated="true");const n=document.querySelector(".footer");if(n&&!n.dataset.gsapFooterAnimated){gsap.set(n,{y:80,autoAlpha:0});const o=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(gsap.to(n,{y:0,autoAlpha:1,duration:.8,ease:"power2.out"}),n.dataset.gsapFooterAnimated="true",o.unobserve(n))})},{threshold:.1});o.observe(n)}}}catch(e){console.error("Error in animateCommonElements:",e)}}function isHomePage(e=document.body){try{var t;return document.body.classList.contains("home")||document.body.classList.contains("homepage")||document.body.classList.contains("home-page")?!0:!!("/"===(t=window.location.pathname)||t.startsWith("/index.html")||t.startsWith("/index.php")||1<t.length&&t.endsWith("/")&&!t.substring(1).includes("/"))}catch(e){return console.error("Error in isHomePage:",e),!1}}function initSliderBlocks(e){e&&0!==e.length&&e.forEach(i=>{if("true"!==i.dataset.sliderInitialized)try{const s=i.querySelector(".slider-track"),l=i.querySelectorAll(".slider-slide");if(s&&0!==l.length){let n=i.querySelector(".slider-control"),o=(n?n.innerHTML="":((n=document.createElement("div")).classList.add("slider-control"),i.insertBefore(n,s)),0),e=null;const d=()=>0<l.length?l[0].offsetWidth:0,c=a=>{var e=-a*d();"undefined"!=typeof gsap?gsap.to(s,{x:e,duration:.6,ease:"power2.out"}):s.style.transform=`translateX(${e}px)`,i.querySelectorAll(".slider-button").forEach((e,t)=>{e.classList.toggle("active",t===a)}),o=a},u=()=>{e&&clearInterval(e),e=null},p=()=>{u(),1<l.length&&(e=setInterval(()=>{var e=(o+1)%l.length;c(e)},3500))};l.forEach((e,t)=>{var a=document.createElement("button");a.classList.add("slider-button"),a.setAttribute("aria-label","Go to slide "+(t+1)),a.addEventListener("click",()=>{u(),c(t),p()}),n.appendChild(a)}),n.firstChild&&n.firstChild.classList.add("active");let a=0,r=!1;s.addEventListener("touchstart",e=>{a=e.touches[0].clientX,r=!0,u(),s.style.transition="none"},{passive:!0}),s.addEventListener("touchmove",e=>{r&&(e.touches[0].clientX,a)},{passive:!0}),s.addEventListener("touchend",t=>{if(r){r=!1,s.style.transition="";t=t.changedTouches[0].clientX,t=a-t;let e=o;50<Math.abs(t)&&(e=0<t?(o+1)%l.length:(o-1+l.length)%l.length),c(e),p()}}),i.addEventListener("mouseenter",u),i.addEventListener("mouseleave",p);let t;window.addEventListener("resize",()=>{clearTimeout(t),t=setTimeout(()=>c(o),250)}),p(),i.dataset.sliderInitialized="true"}}catch(e){console.error("Error in slider block processing:",e)}})}function initTypecardTabs(t,n){t&&0!==t.length&&(t.forEach(e=>{"true"!==e.dataset.tabHandlerAttached&&(e.addEventListener("click",function(){t.forEach(e=>e.classList.remove("typecard__tab_active")),this.classList.add("typecard__tab_active");const a=this.getAttribute("data-tab");a&&n.forEach(e=>{var t=e.getAttribute("id")===a+"-content";e.classList.toggle("typecard__content_active",t),"undefined"!=typeof gsap?t?gsap.fromTo(e,{autoAlpha:0,y:15},{autoAlpha:1,y:0,duration:.4,ease:"power1.out"}):gsap.to(e,{autoAlpha:0,duration:.3}):e.style.display=t?"block":"none"})}),e.dataset.tabHandlerAttached="true")}),!Array.from(t).find(e=>e.classList.contains("typecard__tab_active")))&&0<t.length&&t[0].click()}function initHomePage(e=document.body){try{var t=e.querySelectorAll(".slider-block"),a=(0<t.length&&initSliderBlocks(t),e.querySelectorAll(".typecard__tab")),n=e.querySelectorAll(".typecard__content");0<a.length&&0<n.length&&initTypecardTabs(a,n)}catch(e){console.error("Error in initHomePage:",e)}}function initAnimNumbers(e){e&&0!==e.length&&"undefined"!=typeof gsap&&e.forEach(a=>{if("true"!==a.dataset.gsapAnimatedNum){var e=(a.textContent||"0").match(/^(.*?)((?:\d{1,3}(?:,\d{3})*|\d+)(?:\.\d+)?)(.*)$/);if(e){const n=e[1]||"",o=e[2],r=e[3]||"";e=parseFloat(o.replace(/,/g,""));if(!isNaN(e)){const i=o.includes("."),s=i?o.split(".")[1].length:0,l={value:0};gsap.to(l,{value:e,duration:2,ease:"power1.out",onUpdate:function(){let e;var t;e=i?l.value.toFixed(s):Math.floor(l.value).toString(),o.includes(",")&&((t=e.split("."))[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e=t.join(".")),a.textContent=n+e+r}}),a.dataset.gsapAnimatedNum="true"}}}})}function initSwiperSlider(e=document.body){try{var t,a;"undefined"!=typeof Swiper&&((t=e.querySelector(".typecard__slide"))&&!t.swiper&&new Swiper(t,{slidesPerView:1,loop:!0,speed:800,navigation:{nextEl:".btn-next",prevEl:".btn-prev"},autoplay:{delay:2500,disableOnInteraction:!0}}),(a=e.querySelector(".blog-slider"))&&!a.swiper)&&new Swiper(a,{slidesPerView:1.1,loop:!0,spaceBetween:20,navigation:{nextEl:".btn-next",prevEl:".btn-prev"},breakpoints:{560:{slidesPerView:1.5},991:{slidesPerView:2},1200:{slidesPerView:3}},autoplay:{delay:2500,disableOnInteraction:!0}})}catch(e){console.error("Error in initSwiperSlider:",e)}}function initVideoCarousel(e=document.body){try{if("undefined"!=typeof jQuery){const a=jQuery;var t=a(e).find(".reviews__slider").addBack(".reviews__slider");0!==t.length&&t.each(function(){var e=a(this);e.hasClass("slick-initialized")||e.slick({dots:!0,infinite:!1,slidesToShow:1,slidesToScroll:1,centerMode:!0,centerPadding:"0px",speed:500,variableWidth:!0,cssEase:"ease-in-out",lazyLoad:"ondemand",responsive:[{breakpoint:1200,settings:{slidesToShow:2,slidesToScroll:1}}]})})}}catch(e){console.error("Error in initVideoCarousel:",e)}}function initCalc(e=document.body){try{const s=e.querySelector("#fleet-slider"),l=e.querySelector("#fleet-value"),d=e.querySelector("#fleet-tooltip"),c=e.querySelector("#gallons-slider"),u=e.querySelector("#gallons-value"),p=e.querySelector("#gallons-tooltip"),y=e.querySelector("#savings-amount"),f=e.querySelector("#savings-amount-sm"),m=e.querySelectorAll(".button-group__button");if(s&&c&&y&&"true"!==s.dataset.calcInit){s.dataset.calcInit="true";let a=parseInt(s.value)||1,n=parseInt(c.value)||50,o=1;var t=Array.from(m).find(e=>e.classList.contains("button-group__button--active"));function r(){var e=.5*n*a*o,e=Number.isInteger(e)?e:e.toFixed(1);if("undefined"!=typeof gsap&&y){const t={value:parseFloat(y.textContent.replace(/[^0-9.-]+/g,""))||0};gsap.to(t,{value:parseFloat(e),duration:.5,ease:"power1.out",onUpdate:function(){var e=Number.isInteger(t.value)?Math.floor(t.value):t.value.toFixed(1);y.textContent=""+e,f&&(f.textContent=""+e)}})}else y&&(y.textContent=""+e,f)&&(f.textContent=""+e)}function i(e,t){var a,n,o,r;e&&t&&(a=parseInt(e.min),n=parseInt(e.max),r=parseInt(e.value),o=t.offsetWidth,r=(r-a)/(n-a)*100/100*(e.offsetWidth-20)+10-o/2,r=Math.max(0,Math.min(r,e.offsetWidth-o)),"undefined"!=typeof gsap?gsap.to(t,{left:r+"px",duration:.2,ease:"power1.out"}):t.style.left=r+"px",t.textContent=e.value)}t&&(o=parseInt(t.dataset.value)||1),s&&l&&(s.addEventListener("input",function(){a=parseInt(this.value),l&&(l.textContent=a),i(s,d),r()}),d)&&i(s,d),c&&u&&(c.addEventListener("input",function(){n=parseInt(this.value),u&&(u.textContent=n),i(c,p),r()}),p)&&i(c,p),0<m.length&&m.forEach(e=>{e.addEventListener("click",function(){m.forEach(e=>e.classList.remove("button-group__button--active")),this.classList.add("button-group__button--active"),o=parseInt(this.dataset.value)||1,r()})}),d&&i(s,d),p&&i(c,p),r()}}catch(e){console.error("Error in initCalc:",e)}}function initMultiStepForm(e=document.body){try{const l=e.querySelector(".form");if(l&&"true"!==l.dataset.msfInit){l.dataset.msfInit="true";const d=Array.from(l.querySelectorAll(".form__step, .form-step"));if(!(d.length<2)){var t,a=l.querySelectorAll(".form__step-next, .next-step"),n=l.querySelectorAll(".form__step-back"),o=document.querySelectorAll(".form__step-header ul li, .progress-steps li");const c=new Map,u=(o.forEach(e=>{var t=e.textContent?e.textContent.trim():"";/^\d+$/.test(t)&&0<=(t=parseInt(t,10)-1)&&t<d.length&&c.set(d[t],e)}),d.forEach((e,t)=>{0===t?(e.style.display="block","undefined"!=typeof gsap&&gsap.set(e,{autoAlpha:1}),(t=c.get(e))&&t.classList.add("filled")):(e.style.display="none","undefined"!=typeof gsap&&gsap.set(e,{autoAlpha:0}))}),a.forEach(o=>{o.dataset.msfNextHandler||(o.addEventListener("click",function(e){e.preventDefault();let a=null,n=-1;var t;d.forEach((e,t)=>{e.contains(o)&&(a=e,n=t)}),a&&n<d.length-1&&(e=d[n+1],i(r(a),l))&&((t=c.get(e))&&t.classList.add("filled"),"undefined"!=typeof gsap?gsap.timeline().to(a,{autoAlpha:0,duration:.4,ease:"power2.out"}).set(a,{display:"none"}).set(e,{display:"block"}).to(e,{autoAlpha:1,duration:.4,ease:"power2.in"}):(a.style.display="none",e.style.display="block"))}),o.dataset.msfNextHandler="true")}),n.forEach(o=>{o.dataset.msfBackHandler||(o.addEventListener("click",function(e){e.preventDefault();let a=null,n=-1;var t;d.forEach((e,t)=>{e.contains(o)&&(a=e,n=t)}),a&&0<n&&(e=d[n-1],(t=c.get(a))&&t.classList.remove("filled"),"undefined"!=typeof gsap?gsap.timeline().to(a,{autoAlpha:0,duration:.4,ease:"power2.out"}).set(a,{display:"none"}).set(e,{display:"block"}).to(e,{autoAlpha:1,duration:.4,ease:"power2.in"}):(a.style.display="none",e.style.display="block"))}),o.dataset.msfBackHandler="true")}),l.querySelector('input[type="submit"], button[type="submit"]'));if(u){if(u.dataset.msfSubmitHandler)return;u.addEventListener("click",function(e){var t=d.find(e=>"none"!==e.style.display&&e.contains(u));if(t){const a=r(t);i(a,l)||e.preventDefault()}else{t=d.slice().reverse().find(e=>e.contains(u));if(t){const a=r(t);i(a,l)||e.preventDefault()}}}),u.dataset.msfSubmitHandler="true"}function r(e){const t=[];return e.querySelectorAll('input[aria-required="true"], select[aria-required="true"], textarea[aria-required="true"]').forEach(e=>t.push(e)),e.querySelectorAll("input[required], select[required], textarea[required]").forEach(e=>{t.includes(e)||t.push(e)}),t}function i(e,o){let r=!0;return o.querySelectorAll(".form-error-message").forEach(e=>e.remove()),o.querySelectorAll(".input-error").forEach(e=>{e.classList.remove("input-error")}),e.forEach(e=>{var t,a,n;0===e.offsetWidth&&0===e.offsetHeight&&!e.matches(":hidden")||e.disabled||e.readOnly||e.closest(".step-is-hidden")||(t=e.closest("span.wpcf7-form-control-wrap")||e.closest(".form-field-class")||e.parentNode,"SELECT"===e.tagName?(n=0<e.selectedIndex,a=e.value&&""!==e.value&&!e.value.toLowerCase().includes("select"),n&&a||(r=!1,s(e,t,"Please select an option."))):"checkbox"===e.type||"radio"===e.type?"radio"===e.type&&(n=e.name)?o.querySelector(`input[name="${n}"]:checked`)||(r=!1,s(e,t,"Please select an option.")):e.checked||(r=!1,s(e,t,"This field is required.")):(e.value.trim()||(r=!1,s(e,t,"This field is required.")),"email"===e.type&&e.value.trim()&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.value.trim())&&(r=!1,s(e,t,"Please enter a valid email address."))))}),r}function s(e,t,a){var n;e.classList.add("input-error"),t.querySelector(".form-error-message")||((n=document.createElement("span")).className="form-error-message",n.textContent=a,e.nextSibling?t.insertBefore(n,e.nextSibling):t.appendChild(n),"undefined"!=typeof gsap&&(n.style.opacity="0",gsap.to(n,{opacity:1,duration:.3,ease:"power2.out"}),gsap.fromTo(e,{x:0},{x:5,duration:.1,repeat:3,yoyo:!0,clearProps:"x"})))}document.getElementById("multi-step-form-styles")||((t=document.createElement("style")).id="multi-step-form-styles",t.textContent=`
            .input-error { border-color: red !important; }
            .form-error-message { color: red; font-size: 0.85em; display: block; margin-top: 4px; }
        `,document.head.appendChild(t))}}}catch(e){console.error("Error in initMultiStepForm:",e)}}function initLoginPage(e=document.body){const t=e.querySelector("#login-form-container")||document.getElementById("login-form-container"),a=e.querySelector("#recovery-form-container")||document.getElementById("recovery-form-container");var n=e.querySelector("#show-recovery")||document.getElementById("show-recovery"),o=e.querySelector("#show-login")||document.getElementById("show-login"),r=e.querySelector("#show-contact")||document.getElementById("show-contact");const i=e.querySelector("#contact-popup")||document.getElementById("contact-popup");var s=e.querySelector(".close-popup")||document.querySelector(".close-popup");a&&!a.dataset.gsapInitLp&&(gsap.set(a,{autoAlpha:0,display:"none"}),a.dataset.gsapInitLp="true"),i&&!i.dataset.gsapInitLp&&(gsap.set(i,{autoAlpha:0,display:"none"}),i.dataset.gsapInitLp="true"),n&&o&&t&&a&&(n.dataset.handlerLp||(n.addEventListener("click",function(e){e.preventDefault(),gsap.to(t,{autoAlpha:0,y:-20,duration:.3,ease:"power2.out",onComplete:()=>{gsap.set(t,{display:"none"}),gsap.set(a,{display:"block",y:20,autoAlpha:0}),gsap.to(a,{autoAlpha:1,y:0,duration:.3,ease:"power2.out"})}})}),n.dataset.handlerLp="true"),o.dataset.handlerLp||(o.addEventListener("click",function(e){e.preventDefault(),gsap.to(a,{autoAlpha:0,y:-20,duration:.3,ease:"power2.out",onComplete:()=>{gsap.set(a,{display:"none"}),gsap.set(t,{display:"block",y:20,autoAlpha:0}),gsap.to(t,{autoAlpha:1,y:0,duration:.3,ease:"power2.out"})}})}),o.dataset.handlerLp="true")),r&&i&&s&&(r.dataset.handlerLp||(r.addEventListener("click",function(e){e.preventDefault(),gsap.set(i,{display:"flex"}),gsap.fromTo(i,{autoAlpha:0,scale:.9},{autoAlpha:1,scale:1,duration:.3,ease:"power2.out"})}),r.dataset.handlerLp="true"),s.dataset.handlerLp||(s.addEventListener("click",function(){gsap.to(i,{autoAlpha:0,scale:.9,duration:.3,ease:"power2.in",onComplete:()=>gsap.set(i,{display:"none"})})}),s.dataset.handlerLp="true"),i.dataset.handlerBgLp||(i.addEventListener("click",function(e){e.target===i&&gsap.to(i,{autoAlpha:0,scale:.9,duration:.3,ease:"power2.in",onComplete:()=>gsap.set(i,{display:"none"})})}),i.dataset.handlerBgLp="true"));const l=e.querySelector("#login-form")||document.getElementById("login-form"),d=(l&&!l.dataset.handlerLp&&(l.addEventListener("submit",function(e){var t=l.querySelector("#user_login"),a=l.querySelector("#user_pass");t.value&&a.value||(e.preventDefault(),"undefined"!=typeof gsap&&gsap.to(l,{x:[-10,10,-8,8,-5,5,0],duration:.5,ease:"power2.out"}),alert("Please fill in all fields."))}),l.dataset.handlerLp="true"),e.querySelector("#recovery-form")||document.getElementById("recovery-form")),c=(d&&!d.dataset.handlerLp&&(d.addEventListener("submit",function(e){d.querySelector("#user_email").value||(e.preventDefault(),"undefined"!=typeof gsap&&gsap.to(d,{x:[-10,10,-8,8,-5,5,0],duration:.5,ease:"power2.out"}),alert("Please enter email or username."))}),d.dataset.handlerLp="true"),e.querySelector("#contact-form")||document.getElementById("contact-form"));c&&!c.dataset.handlerLp&&i&&(c.addEventListener("submit",function(e){e.preventDefault(),alert("Your message has been sent. We will contact you shortly."),"undefined"!=typeof gsap&&i?gsap.to(i,{autoAlpha:0,scale:.9,duration:.3,ease:"power2.in",onComplete:()=>{gsap.set(i,{display:"none"}),c.reset()}}):i&&(i.style.display="none",c.reset())}),c.dataset.handlerLp="true");n=new URLSearchParams(window.location.search),n.has("login")&&"failed"===n.get("login")&&(alert("Incorrect login or password. Please try again."),window.history.replaceState)&&(o=window.location.protocol+"//"+window.location.host+window.location.pathname,window.history.replaceState({path:o},"",o)),r=e.querySelector(".toggle-password")||document.querySelector(".toggle-password");r&&!r.dataset.handlerLp&&(r.addEventListener("click",togglePasswordVisibility),r.dataset.handlerLp="true")}function togglePasswordVisibility(){var e=document.getElementById("user_pass"),t=document.querySelector(".toggle-password");e&&t&&("password"===e.type?(e.type="text",t.classList.add("visible")):(e.type="password",t.classList.remove("visible")))}